<?php
/**
 * Created by IntelliJ IDEA.
 * User: victor
 * Date: 3/5/14
 * Time: 3:49 PM
 * To change this template use File | Settings | File Templates.
 */

function joinPaths(){
    $args = func_get_args();
    $paths = array();
    foreach($args as $arg) {
        $paths = array_merge( $paths, (array)$arg );
    }

    foreach($paths as &$path) {
        $path = trim( $path, '/' );
    }

    $paths = array_filter($paths);

    // make sure if the path was originally an absolute path that it is kept that way
    if(substr( $args[0], 0, 1 ) == '/' ) {
        $paths[0] = '/' . $paths[0];
    }

    return join('/', $paths);

}

function get_file_ext($filename){
    return substr(strrchr($filename, '.'), 1);
}

function get_filename_without_ext($filename){
    $pos = strripos($filename, '.');
    if($pos === false){
        return $filename;
    } else {
        return substr($filename, 0, $pos);
    }
}

function get_base_url_install(){
    return sprintf(
        "%s://%s",
        isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] != 'off' ? 'https' : 'http',
        $_SERVER['HTTP_HOST']
    );
}

function abs_path($path){
    if (substr($path, 0, 1) == "/"){
        return $path;
    } else {
        return joinPaths(dirname(__DIR__),$path);
    }
}

function write_ini_file($assoc_arr, $path, $has_sections=FALSE) {
    $content = "";
    if ($has_sections) {
        foreach ($assoc_arr as $key=>$elem) {
            $content .= "[".$key."]\n";
            foreach ($elem as $key2=>$elem2) {
                if(is_array($elem2))
                {
                    for($i=0;$i<count($elem2);$i++)
                    {
                        $content .= $key2."[] = \"".$elem2[$i]."\"\n";
                    }
                }
                else if($elem2=="") $content .= $key2." = \n";
                else $content .= $key2." = \"".$elem2."\"\n";
            }
        }
    }
    else {
        foreach ($assoc_arr as $key2=>$elem) {
            if(is_array($elem))
            {
                for($i=0;$i<count($elem);$i++)
                {
                    $content .= $key2."[] = \"".$elem[$i]."\"\n";
                }
            }
            else if($elem=="") $content .= $key2 . " = \n";
            else $content .= $key2 . " = " . $elem . "\n";
        }
    }
    if(!is_writable(dirname($path))) return false;
    if (!$handle = fopen($path, 'w')) {
        return false;
    }
    if (!fwrite($handle, $content)) {
        return false;
    }
    fclose($handle);

    return true;
}

function install_clean_database($db_file, $db_host, $db_user, $db_pass, $db_name){
    if( ! defined('DB_HOST')) define('DB_HOST', $db_host);
    if( ! defined('DB_USER')) define('DB_USER', $db_user);
    if( ! defined('DB_PWD')) define('DB_PWD', $db_pass);
    if( ! defined('DB_NAME')) define('DB_NAME', $db_name);
    require_once(abs_path('install/db.php'));
    require_once(abs_path('install/db_schema_update.php'));

    /*if(file_exists($db_file)){
        $query = "source '" . $db_file . "'";
        return db::db_query($query);
    }*/
    $bb=true;
    foreach($tables as $table_name=>$tsa){
        $create_stmt = $tsa['create_stmt'];
        $bb &= db::db_query('drop table if exists ' . $table_name);
        $bb &= db::db_query($create_stmt);
    }
    $q = "insert into users (id, login, fname, lname, password, email, administrator, `type`, is_manager, allow_private, customer_id) values  (1, 'admin', 'admin', '', md5('admin1234'), 'admin@yourdomain.com', 1, 2, 1, 1, 0)";
    db::db_query($q);
    db::db_query("insert into users_customers values (1,0)");
    db::db_query("REPLACE INTO `tickets_types` VALUES (1,'Support',1,0,1),(2,'Task',0,0,1),(3,'Labo',0,0,0),(4,'RFQ',0,0,0),(5,'Planning',0,0,0),(6,'SALES',0,0,0)");
    db::db_query("REPLACE INTO `tickets_statuses` VALUES (1,'New',0),(2,'Opened',0),(3,'Waiting',0),(10,'Closed',0),(5,'Overdue',0),(11,'Scheduled',0),(12,'WFC',0),(13,'Confirmed',0),(14,'TBS',0)");
    db::db_query("REPLACE INTO `acl_categories` VALUES (1,'Computers'),(2,'Monitor profiles'),(3,'Users'),(4,'Customer - Krifs'),(5,'Krifs'),(6,'Customers Informations'),(7,'Asterisk'),(8,'Customer - Kawacs'),(9,'Customer - Kerm'),(10,'Customer Contracts')");
    db::db_query("REPLACE INTO `acl_items` VALUES (1,'View computers',0,1),(2,'Edit computers',0,1),(3,'Delete computers',0,1),(4,'View profiles',0,2),(5,'Edit profiles',0,2),(6,'Delete profiles',0,2),(7,'Edit monitor items',0,2),(8,'View users',0,3),(9,'Edit users',0,3),(10,'Delete users',0,3),(11,'View tickets',0,4),(12,'Edit tickets',0,4),(13,'View interventions',0,4),(14,'Krif',0,5),(15,'Customer licenses',0,6),(16,'Peripherals',0,6),(17,'Active directory Informations',0,6),(18,'Contrats et informations customers',0,6),(19,'Phone operator',0,7),(21,'View Dashboards',0,8),(22,'Manage Users',0,9),(23,'View contracts',0,10)");
    db::db_query("REPLACE INTO `acl_items_operations` VALUES (113,2,'kawacs','computer_edit_item'),(114,2,'kawacs','computer_edit_item_del'),(115,2,'kawacs','computer_profile'),(116,2,'kawacs','computer_remote_access'),(117,2,'kawacs','computer_type'),(118,2,'kawacs','computer_view'),(119,2,'kawacs','computer_view_log'),(408,1,'kawacs','alert_add'),(121,7,'kawacs','manage_monitor_items'),(122,7,'kawacs','monitor_item_add'),(123,7,'kawacs','monitor_item_delete'),(110,1,'kawacs','computer_profile'),(111,1,'kawacs','computer_view_log'),(112,1,'kawacs','manage_computers'),(124,7,'kawacs','monitor_item_edit'),(125,7,'kawacs','monitor_item_submit'),(126,3,'customer_krifs','manage_tickets'),(130,12,'customer_krifs','ticket_edit'),(129,12,'customer_krifs','ticket_add'),(131,11,'customer_krifs','manage_tickets'),(132,12,'customer_krifs','manage_tickets'),(133,12,'customer_krifs','ticket_attachment_add'),(134,12,'customer_krifs','ticket_attachment_delete'),(135,12,'customer_krifs','ticket_attachment_open'),(136,12,'customer_krifs','ticket_escalate'),(137,13,'customer_krifs','manage_interventions'),(279,14,'krifs','ticket_add_intervention'),(278,14,'krifs','ticket_add_check_notifs'),(277,14,'krifs','ticket_add'),(272,14,'krifs','status_edit'),(271,14,'krifs','status_delete'),(270,14,'krifs','status_add'),(269,14,'krifs','search_ticket'),(268,14,'krifs','search_intervention'),(267,14,'krifs','saved_search_edit'),(266,14,'krifs','saved_search_add'),(265,14,'krifs','report_krifs_outstanding_tickets'),(264,14,'krifs','popup_ticket_search_by_user'),(263,14,'krifs','popup_ticket_add_objects'),(262,14,'krifs','popup_ticket_add_cc_users'),(261,14,'krifs','popup_hours'),(260,14,'krifs','popup_fill_ts_gaps'),(259,14,'krifs','popup_activity'),(255,14,'krifs','manage_tickets'),(422,1,'kawacs','cklogs_free_space'),(230,14,'krifs','activity_edit'),(229,14,'krifs','activity_delete'),(228,14,'krifs','activity_category_edit'),(227,14,'krifs','activity_category_delete'),(226,14,'krifs','activity_category_add'),(225,14,'krifs','activity_add'),(224,14,'krifs','action_type_edit'),(421,1,'kawacs','cklogs_ad_computers'),(222,14,'krifs','action_type_add'),(280,14,'krifs','ticket_attachment_add'),(281,14,'krifs','ticket_attachment_delete'),(282,14,'krifs','ticket_attachment_open'),(283,14,'krifs','ticket_detail_edit'),(284,14,'krifs','ticket_detail_edit_user'),(285,14,'krifs','ticket_detail_intervention'),(286,14,'krifs','ticket_edit'),(287,14,'krifs','ticket_edit_cc'),(288,14,'krifs','ticket_edit_customer'),(289,14,'krifs','ticket_edit_manager_comments'),(290,14,'krifs','ticket_mark_working'),(291,14,'krifs','ticket_object_add'),(293,14,'krifs','ticket_unmark_working'),(420,1,'kawacs','cklogs_1030_1046'),(419,1,'kawacs','blackouts_remove'),(418,1,'kawacs','blackouts_edit'),(417,1,'kawacs','blackout_computer'),(416,1,'kawacs','alert_profiles_edit'),(415,1,'kawacs','alert_edit_recips'),(301,14,'krifs','type_add'),(302,14,'krifs','type_delete'),(303,14,'krifs','type_edit'),(304,14,'krifs','xml_get_customer_cc_recipients'),(305,14,'krifs','xml_get_schedules'),(308,15,'kalm','license_computers'),(314,15,'kalm','license_file_open'),(551,15,'kalm','manage_licenses'),(321,15,'kalm','software_customers'),(327,16,'kawacs','peripheral_add'),(328,16,'kawacs','peripheral_class_add'),(329,16,'kawacs','peripheral_class_customers'),(330,16,'kawacs','peripheral_class_delete'),(331,16,'kawacs','peripheral_class_edit'),(332,16,'kawacs','peripheral_class_peripherals'),(333,16,'kawacs','peripheral_class_profile'),(334,16,'kawacs','peripheral_class_profile_remove'),(335,16,'kawacs','peripheral_delete'),(336,16,'kawacs','peripheral_edit'),(337,16,'kawacs','peripheral_edit_snmp'),(338,16,'kawacs','peripheral_field_add'),(339,16,'kawacs','peripheral_field_delete'),(366,18,'klara','access_phone_edit'),(365,18,'klara','access_phone_delete'),(363,17,'kerm','logon_computers'),(362,17,'kerm','ad_user_view'),(361,17,'kerm','ad_printer_warranty_edit'),(360,17,'kerm','ad_printer_view'),(359,17,'kerm','ad_printer_location'),(358,17,'kerm','ad_printer_edit_snmp'),(357,17,'kerm','ad_printer_date'),(356,17,'kerm','ad_group_view'),(364,18,'klara','access_phone_add'),(355,17,'kerm','ad_computer_view'),(367,18,'klara','computer_password_add'),(368,18,'klara','computer_password_delete'),(369,18,'klara','computer_password_edit'),(370,18,'klara','computer_password_expire'),(371,18,'klara','computer_passwords_expired'),(372,18,'klara','computer_remote_service_add'),(373,18,'klara','computer_remote_service_delete'),(374,18,'klara','computer_remote_service_edit'),(375,18,'klara','computer_remote_services'),(376,18,'klara','customer_internet_contract_add'),(377,18,'klara','customer_internet_contract_attachment_add'),(378,18,'klara','customer_internet_contract_attachment_delete'),(379,18,'klara','customer_internet_contract_attachment_open'),(380,18,'klara','customer_internet_contract_delete'),(381,18,'klara','customer_internet_contract_edit'),(382,18,'klara','customer_internet_contract_remove_again_mark'),(383,18,'klara','customer_internet_contract_remove_mark'),(384,18,'klara','customer_internet_contract_set_notifs'),(385,18,'klara','manage_access'),(386,18,'klara','manage_access_phones'),(387,18,'klara','manage_customer_internet_contracts'),(409,1,'kawacs','alert_condition_add'),(390,18,'klara','provider_contact_add'),(414,1,'kawacs','alert_edit_fields_send'),(413,1,'kawacs','alert_edit'),(412,1,'kawacs','alert_delete'),(395,18,'klara','provider_contact_phone_edit'),(396,18,'klara','provider_contract_add'),(411,1,'kawacs','alert_condition_edit'),(399,18,'klara','provider_customers'),(410,1,'kawacs','alert_condition_delete'),(401,18,'klara','provider_edit'),(402,18,'klara','remote_access_add'),(403,18,'klara','remote_access_delete'),(404,18,'klara','remote_access_edit'),(405,17,'kerm','manage_ad_computers'),(406,17,'kerm','manage_ad_printers'),(407,17,'kerm','manage_ad_users'),(423,1,'kawacs','computer_add'),(424,1,'kawacs','computer_comments'),(425,1,'kawacs','computer_customer'),(426,1,'kawacs','computer_date_created'),(427,1,'kawacs','computer_event_unignore'),(428,1,'kawacs','computer_events_revert_to_profile'),(429,1,'kawacs','computer_events_settings'),(430,1,'kawacs','computer_events_settings_edit'),(431,1,'kawacs','computer_events_src_add'),(432,1,'kawacs','computer_events_src_delete'),(433,1,'kawacs','computer_events_src_edit'),(434,1,'kawacs','computer_location'),(435,1,'kawacs','computer_mac_edit'),(436,1,'kawacs','computer_name_swings_clean'),(437,1,'kawacs','computer_note_add'),(438,1,'kawacs','computer_note_delete'),(439,1,'kawacs','computer_note_edit'),(440,1,'kawacs','computer_remote_access'),(441,1,'kawacs','computer_report_av'),(442,1,'kawacs','computer_report_backup_sizes'),(443,1,'kawacs','computer_report_backups'),(444,1,'kawacs','computer_report_partitions'),(445,1,'kawacs','computer_roles'),(446,1,'kawacs','computer_type'),(447,1,'kawacs','computer_view'),(448,1,'kawacs','computer_view_item'),(449,1,'kawacs','computer_view_item_detail'),(452,1,'kawacs','computers_linux_agent_versions'),(453,1,'kawacs','computers_linux_agent_versions_details'),(454,1,'kawacs','computers_merge'),(455,1,'kawacs','computers_merge_confirm'),(456,1,'kawacs','computers_merge_finished'),(457,1,'kawacs','customer_allowed_ip_add'),(458,1,'kawacs','customer_allowed_ip_delete'),(459,1,'kawacs','customers_allowed_ips'),(460,1,'kawacs','customers_computer_count'),(461,1,'kawacs','inventory_search_advanced'),(465,1,'kawacs','kawacs_inventory_dashboard'),(466,1,'kawacs','kawacs_linux_update_add'),(467,1,'kawacs','kawacs_linux_update_delete'),(468,1,'kawacs','kawacs_linux_update_edit'),(469,1,'kawacs','kawacs_linux_update_publish'),(470,1,'kawacs','kawacs_update_add'),(471,1,'kawacs','kawacs_update_delete'),(472,1,'kawacs','kawacs_update_edit'),(473,1,'kawacs','kawacs_update_preview_add'),(474,1,'kawacs','kawacs_update_preview_delete'),(475,1,'kawacs','kawacs_update_publish'),(476,1,'kawacs','kawacs_update_remove_file'),(479,1,'kawacs','manage_kawacs_linux_updates'),(480,1,'kawacs','manage_kawacs_updates'),(482,1,'kawacs','manage_monitor_items_peripherals'),(486,1,'kawacs','manage_peripherals'),(489,1,'kawacs','manage_profiles_periph'),(492,1,'kawacs','monitor_item_add'),(494,1,'kawacs','monitor_item_edit'),(495,1,'kawacs','monitor_item_submit'),(514,1,'kawacs','monitored_ip_add'),(515,1,'kawacs','monitored_ip_delete'),(516,1,'kawacs','monitored_ip_edit'),(517,1,'kawacs','open_item_file'),(518,1,'kawacs','peripheral_add'),(520,1,'kawacs','peripheral_class_customers'),(521,1,'kawacs','peripheral_class_delete'),(522,1,'kawacs','peripheral_class_edit'),(523,1,'kawacs','peripheral_class_peripherals'),(525,1,'kawacs','peripheral_class_profile_remove'),(526,1,'kawacs','peripheral_delete'),(527,1,'kawacs','peripheral_edit'),(528,1,'kawacs','peripheral_edit_snmp'),(530,1,'kawacs','peripheral_field_delete'),(531,1,'kawacs','peripheral_field_edit'),(532,1,'kawacs','peripheral_field_order'),(533,1,'kawacs','peripheral_location'),(540,1,'kawacs','popup_traceroute'),(546,1,'kawacs','search_computer'),(547,1,'kawacs','search_serial'),(548,1,'kawacs','valid_dup_name_add'),(549,1,'kawacs','valid_dup_name_delete'),(550,1,'kawacs','valid_dup_names'),(552,15,'kalm','manage_software'),(553,18,'customer','cc_recipients_edit'),(554,18,'customer','customer_add'),(555,18,'customer','customer_comment_add'),(556,18,'customer','customer_comment_delete'),(557,18,'customer','customer_contact_add'),(558,18,'customer','customer_contact_edit'),(559,18,'customer','customer_contact_phone_add'),(560,18,'customer','customer_contact_phone_edit'),(561,18,'customer','customer_delete'),(562,18,'customer','customer_edit'),(563,18,'customer','customer_lock'),(564,18,'customer','customer_photo_delete'),(565,18,'customer','customer_photo_edit'),(566,18,'customer','customer_photo_show'),(567,18,'customer','customer_photo_view'),(568,18,'customer','customer_report'),(569,18,'customer','customer_view'),(570,18,'customer','location_comment_add'),(571,18,'customer','location_comment_delete'),(572,18,'customer','location_computers'),(573,18,'customer','location_fixed_customers'),(574,18,'customer','location_fixed_edit'),(575,18,'customer','manage_customers'),(576,18,'customer','manage_customers_comments'),(577,18,'customer','manage_customers_contacts'),(578,19,'asterisk','detect'),(579,21,'customer_kawacs','kawacs_antivirus_dashboard'),(580,21,'customer_kawacs','kawacs_backup_dashboard'),(581,22,'customer_kerm','manage_users'),(582,22,'customer_kerm','add_user'),(583,22,'customer_kerm','modify_user'),(584,11,'customer_krifs','customer_satisfaction'),(585,23,'customer_contracts','customer_manage_contracts')");
    db::db_query("REPLACE INTO `acl_roles` VALUES (1,'Support assistant',1),(2,'Computers technician',1),(3,'Users manager',1),(4,'Secretary',1),(5,'Computers manager',1),(6,'Customer',2),(7,'KeyOS Opérateur',1),(8,'Customers Administrator',1)");
    db::db_query("REPLACE INTO `acl_roles_items` VALUES (1,1),(2,1),(3,1),(5,1),(6,1),(7,1),(8,1),(2,2),(5,2),(7,2),(2,3),(5,3),(2,4),(3,4),(5,4),(7,4),(8,4),(8,5),(2,8),(4,8),(5,8),(7,8),(8,8),(1,11),(2,11),(3,11),(5,11),(6,11),(7,11),(8,11),(1,12),(5,12),(6,12),(7,12),(8,12),(1,13),(5,13),(6,13),(7,13),(8,13),(1,14),(3,14),(5,14),(8,14),(2,15),(3,15),(5,15),(8,15),(2,16),(3,16),(5,16),(8,16),(2,17),(3,17),(5,17),(8,17),(2,18),(3,18),(5,18),(8,18),(6,21),(6,22),(6,23)");
    db::db_query("REPLACE INTO `monitor_items` VALUES (1,1011,'total','Total',6,1,0,1,1,0,0,0,0,0,0,0,'',0),(2,1011,'total_virtual','Total virtual',6,1,0,1,1,0,0,0,0,0,0,0,'',0),(3,1011,'free','Free',6,1,0,1,1,0,0,0,0,0,0,0,'',0),(4,1006,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(5,1006,'speed','Speed',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(6,1006,'speed_unit','Speed unit',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(7,1012,'model','Model',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(8,1012,'size','Size',6,1,0,1,1,0,0,0,0,0,0,0,'',0),(9,1013,'unc','Path',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(10,1013,'type','Type',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(11,1013,'serial_number','Serial number',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(12,1013,'size','Size',6,1,0,1,1,0,0,3,0,0,0,0,'',0),(13,1013,'free','Free',6,1,0,1,1,0,5,3,0,0,0,0,'',0),(14,1010,'location','Socket',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(15,1010,'size','Size',6,1,0,1,1,0,0,0,0,0,0,0,'',0),(16,1010,'type','Type',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(17,1011,'free_virtual','Free virtual',6,1,0,1,1,0,0,0,0,0,0,0,'',0),(18,1021,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(19,1021,'mac_address','Mac address',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(20,1021,'ip_address','IP address',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(21,1021,'dhcp','DHCP',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(22,1021,'gateway','Gateway',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(23,1025,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(24,1025,'last_update','Last update',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(25,1026,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(26,1026,'running','Running',9,1,0,1,1,0,0,1,2,0,0,0,'',0),(27,2001,'product','Product',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(32,1027,'pwd_hash','Password hash',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(33,1027,'port','Port',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(34,2004,'date','Date',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(35,2004,'status','Status',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(36,2004,'tape_id','Tape ID',2,1,0,1,1,0,0,1,0,1,0,0,'',0),(37,2004,'start','Start',7,1,0,1,1,0,0,1,0,1,1,0,'',0),(38,2004,'end','End',7,1,0,1,1,0,0,1,0,1,1,0,'',0),(39,2004,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(40,2004,'version','Version',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(41,2004,'jobs','Jobs',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(42,2004,'message','Message',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(43,2004,'files','Files',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(44,2004,'size','Size',6,1,0,1,1,0,0,0,0,0,0,0,'',0),(45,2004,'backup_log','Backup log',8,1,0,1,1,0,0,0,0,0,0,0,'',0),(46,2004,'count','Count',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(47,1028,'display_name','Display name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(48,1028,'given_name','Given Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(49,1028,'home_dir','Home directory',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(50,1028,'home_drive','Home drive',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(51,1028,'home_mdb','Home MDB',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(52,1028,'email','Email',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(53,1028,'email_nickname','Email nickname',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(54,1028,'mdb_use_defaults','MDB use defaults',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(55,1028,'exch_home_server','Exchange home server',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(56,1028,'profile_path','Profile path',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(57,1028,'sam_account_name','SAM account name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(58,1028,'sn','SN',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(59,1028,'user_principal_name','User principal name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(60,1028,'distinguished_name','DN',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(61,1029,'distinguished_name','Distinguished name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(62,1029,'account_expires','Account expires',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(63,1029,'bad_password_time','Bad password time',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(64,1029,'bad_password_count','Bad password count',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(65,1029,'c','C',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(66,1029,'canonical_name','Canonical name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(67,1029,'co','CO',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(68,1029,'cn','CN',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(69,1029,'create_time','Create time',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(70,1029,'home_mta','Home MTA',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(71,1029,'l','L',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(72,1029,'last_logoff','Last logoff',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(73,1029,'last_logon','Last logon',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(74,1029,'legacy_exchange_dn','Legacy exchange DN',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(75,1029,'logon_count','Logon count',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(76,1029,'member_of','Member of',3,1,0,1,1,0,0,0,0,0,0,0,'',0),(77,1029,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(78,1029,'object_category','Object category',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(79,1029,'physical_delivery_office','Physical delivery office',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(80,1029,'postal_code','Postal code',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(81,1029,'proxy_addresses','Proxy addresses',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(82,1029,'pwd_last_set','Password last set',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(83,1029,'st','ST',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(84,1029,'street_address','Street address',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(85,1029,'telephone','Telephone',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(86,1029,'when_changed','When changed',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(87,1029,'when_created','When created',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(88,1030,'distinguished_name','Distinguished name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(89,1031,'distinguished_name','Distinguished name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(90,1031,'canonical_name','Canonical name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(91,1031,'cn','CN',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(92,1031,'create_time','Create time',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(93,1031,'description','Description',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(94,1031,'driver_name','Driver name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(95,1031,'driver_version','Driver version',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(96,1031,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(97,1031,'object_category','Object category',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(98,1031,'location','Location',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(99,1031,'port_name','Port name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(100,1031,'print_bin_names','Print bin names',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(101,1031,'print_color','Print color',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(102,1031,'print_duplex_supported','Print duplex supported',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(103,1031,'printer_name','Printer name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(104,1031,'print_max_resolution','Print max resolution',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(105,1031,'print_media_supported','Print media supported',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(106,1031,'print_memory','Print memory',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(107,1031,'print_orientations','Print orientations',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(108,1031,'server_name','Server name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(109,1031,'unc_name','UNC name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(110,1031,'when_changed','whenChanged',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(111,1031,'when_created','When created',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(112,1032,'distinguished_name','Distinguished name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(113,1030,'account_expires','Account expires',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(114,1030,'bad_password_time','Bad password time',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(115,1030,'bad_password_count','Bad password count',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(116,1030,'canonical_name','Canonical name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(117,1030,'cn','CN',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(118,1030,'display_name','Display name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(119,1030,'dns_host_name','DNS host name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(120,1030,'last_logoff','Last logoff',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(121,1030,'last_logon','Last logon',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(122,1030,'logon_count','Logon count',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(123,1030,'member_of','Member of',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(124,1030,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(125,1030,'object_category','Object category',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(126,1030,'object_sid','Object SID',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(127,1030,'pwd_last_set','Password last set',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(128,1030,'operating_system','Operating system',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(129,1030,'operating_system_sp','Operating system SP',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(130,1030,'operating_system_version','Operating system version',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(131,1030,'when_changed','When changed',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(132,1030,'when_created','When created',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(133,1032,'canonical_name','Canonical name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(134,1032,'cn','CN',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(135,1032,'group_type','Group type',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(136,1032,'member','Member',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(137,1032,'member_of','Member of',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(138,1032,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(139,1032,'object_category','Object category',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(140,1032,'when_changed','When changed',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(141,1032,'when_created','When created',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(142,1037,'version','Version',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(143,1037,'release_date','Release date',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(144,1038,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(145,1038,'version','Version',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(146,1039,'product','Product',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(147,1039,'version','Version',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(148,1039,'ip_address','IP address',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(149,1039,'ip_subnet','IP subnet',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(150,1039,'ip_gateway','IP gateway',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(151,1039,'pcmcia_card','PCMCIA card',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(152,1040,'type','Type',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(153,1040,'used','Used',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(154,1040,'data_bus_width','Data bus width',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(155,1040,'slot_speed','Slot speed',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(156,1040,'adapter_speed','Adapter speed',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(157,1040,'length','Length',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(158,1040,'voltage','Voltage',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(159,1040,'device_manufacturer','Device manufacturer',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(160,1040,'device_name','Device name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(161,1040,'is_faulty','Is faulty',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(162,1040,'ext_name','ExtName',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(163,1040,'hot_plug','Hot plug',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(164,1041,'id','ID',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(165,1041,'status','Status',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(166,1041,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(167,1041,'slot_id','Slot ID',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(168,1041,'firmware_version','Firmware version',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(169,1041,'channels','Channels',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(170,1041,'alarm_state','Alarm state',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(171,1042,'id','ID',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(172,1042,'status','Status',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(173,1042,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(174,1042,'state','State',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(175,1042,'progress','Progress',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(176,1042,'layout','Layout',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(177,1042,'size','Size',6,1,0,1,1,0,0,0,0,0,0,0,'',0),(178,1042,'device_name','Device name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(179,1042,'controller_id','Controller ID',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(180,1043,'id','ID',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(181,1043,'status','Status',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(183,1043,'state','State',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(184,1043,'size','Size',6,1,0,1,1,0,0,0,0,0,0,0,'',0),(185,1043,'used_space','Used space',6,1,0,1,1,0,0,0,0,0,0,0,'',0),(186,1043,'manufacturer','Manufacturer',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(187,1043,'model','Model',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(188,1043,'revision','Revision',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(189,1043,'progress','Progress',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(190,1043,'hot_spare','Hot spare',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(191,1013,'volume','Volume',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(192,1044,'date','Date',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(193,1044,'status','Status',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(194,1044,'tapeid','Tape ID',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(195,1044,'start','Start',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(196,1044,'end','End',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(197,1044,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(198,1044,'version','Version',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(199,1044,'jobs','Jobs',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(200,1044,'message','Message',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(201,1044,'files','Files',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(202,1044,'size','Size',6,1,0,1,1,0,0,0,0,0,0,0,'',0),(203,1044,'count','Count',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(204,1044,'summary_log','Summary log',8,1,0,1,1,0,0,0,0,0,0,0,'',0),(205,1044,'mail_log','Mail log',8,1,0,1,1,0,0,0,0,0,0,0,'',0),(206,1044,'last_good_backup','Last good backup',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(207,2001,'sn','Serial number',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(208,2001,'warranty_starts','Warranty starts',7,1,0,1,1,0,0,1,0,0,0,0,'',0),(209,2001,'warranty_ends','Warranty ends',7,1,0,1,1,0,0,1,0,0,0,0,'',0),(210,2001,'service_package_id','Service package',9,1,0,1,1,0,0,1,4,0,0,0,'',0),(211,2001,'service_level_id','Service level',9,1,0,1,1,0,0,1,3,0,0,0,'',0),(212,2001,'contract_number','Contract number',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(213,2001,'hw_product_id','Hardware product ID',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(214,1045,'account_name','Account name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(215,1045,'total_size','Total size',6,1,0,1,1,0,5,3,0,0,0,0,'',0),(216,1045,'profile_size','Profile size',6,1,0,1,1,0,5,3,0,0,0,0,'',0),(217,1045,'home_size','Home size',6,1,0,1,1,0,5,3,0,0,0,0,'',0),(218,1045,'ts_profile_size','TS profile size',6,1,0,1,1,0,5,3,0,0,0,0,'',0),(219,1045,'exchange_mailbox_size','Exchange mailbox size',6,1,0,1,1,0,5,3,0,0,0,0,'',0),(220,1045,'desktop_size','Desktop size',6,1,0,1,1,0,5,3,0,0,0,0,'',0),(221,1045,'my_documents_size','My Documents size',6,1,0,1,1,0,5,3,0,0,0,0,'',0),(222,1045,'exchange_mailbox_items','Exchange mailbox items',1,1,0,1,1,0,0,0,0,0,0,0,'',0),(223,1045,'pst_private_size','PST Private File',6,1,0,1,1,0,5,3,0,0,0,0,'',0),(224,1045,'pst_imap_size','PST IMAP File',6,1,0,1,1,0,5,3,0,0,0,0,'',0),(225,1046,'distinguished_name','Distinguished name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(226,1046,'account_expires','Account expires',7,1,0,1,1,0,0,0,0,1,0,0,'',0),(227,1046,'canonical_name','Canonical name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(228,1046,'cn','CN',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(229,1046,'display_name','Display name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(230,1046,'dns_host_name','DNS host name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(231,1046,'member_of','Member of',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(232,1046,'name','Name',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(233,1046,'object_category','Object category',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(234,1046,'object_sid','Object SID',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(235,1047,'cn','CN',2,1,0,1,1,0,0,1,0,0,0,0,'',0),(236,1047,'bad_password_time','Bad password time',7,1,0,1,1,0,0,1,0,1,0,0,'',0),(237,1047,'bad_password_count','Bad password count',1,1,0,1,1,0,0,1,0,0,0,0,'',0),(238,1047,'last_logoff','Last logoff',7,1,0,1,1,0,0,1,0,1,0,0,'',0),(239,1047,'last_logon','Last logon',7,1,0,1,1,0,0,1,0,1,0,0,'',0),(240,1047,'logon_count','Logon count',1,1,0,1,1,0,0,1,0,0,0,0,'',0),(241,1047,'pwd_last_set','Password last set',7,1,0,1,1,0,0,1,0,1,0,0,'',0),(242,1047,'when_changed','When changed',7,1,0,1,1,0,0,1,0,1,0,0,'',0),(243,1047,'when_created','When created',7,1,0,1,1,0,0,1,0,1,0,0,'',0),(244,1046,'operating_system','Operating system',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(245,1046,'operating_system_sp','Operating system SP',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(246,1046,'operating_system_version','Operating system version',2,1,0,1,1,0,0,0,0,0,0,0,'',0),(247,2001,'raise_alert','Raise alert',9,1,0,1,1,0,0,1,1,0,0,0,'',0),(248,2001,'replaced_ignored','Replaced/Ignored',9,1,0,1,1,0,0,1,1,0,0,0,'',0),(251,3000,'date','Date',7,1,0,1,1,0,0,1,0,1,1,0,'',0),(252,3000,'category','Category',9,1,0,1,1,0,0,1,5,0,0,0,'',0),(253,3000,'type','Type',9,1,0,1,1,0,0,1,6,0,0,0,'',0),(254,3000,'source','Source',9,1,0,1,1,0,0,1,7,0,0,0,'',0),(255,3000,'event_id','Event ID',1,1,0,1,1,0,0,1,0,0,0,0,'',0),(256,3000,'description','Description',3,1,0,1,1,0,0,1,0,0,0,0,'',0),(257,3000,'ignored','Ignored',9,1,0,1,1,0,0,1,1,0,0,0,'',0),(258,1500,'description','Description',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.1.1.0',1302),(259,1500,'uptime','Uptime',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.1.3.0',1304),(260,1500,'contact','Contact',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.1.4.0',1305),(261,1501,'chassis_state','Chassis state',1,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.4.1.674.10892.1.200.10.1.3',230),(262,1501,'chassis_status','Chassis status',1,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.4.1.674.10892.1.200.10.1.4',231),(263,5000,'description','Description',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.2.2.1.2',1521),(264,5000,'interface_type','Interface type',1,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.2.2.1.3',1522),(265,5001,'model','Model',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.25.3.2.1.3.1',0),(266,5001,'memory','Memory',1,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.43.10.2',0),(267,5001,'sn','Serial number',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.43.5.1.1.17.1',0),(268,5003,'page_count','Page count',1,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.43.10.2.1.4.1.1',0),(270,5004,'cover','Cover',1,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.43.6.1.1.1',3498),(271,5004,'description','Description',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.43.6.1.1.2',3499),(272,5004,'status','Status',1,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.43.6.1.1.3',3500),(273,5005,'device_type','Device type',1,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.25.3.2.1.2',3307),(274,5005,'descr','Descr',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.25.3.2.1.3',3308),(275,5005,'status','Status',1,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.25.3.2.1.5',3310),(276,5005,'errors','Errors',1,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.2.1.25.3.2.1.6',3311),(277,1502,'systemStatePowerSupplySta','Power Supply Status Combined',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.4.1.674.10892.1.200.10.1.9',236),(278,1503,'arrayDiskState','Array Disk State',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.4.1.674.10893.1.20.130.4.1.4',4026),(279,1503,'arrayDiskNumber','Array Disk Number',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.4.1.674.10893.1.20.130.4.1.1',4023),(280,1503,'arrayDiskName','Array Disk Name',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.4.1.674.10893.1.20.130.4.1.2',4024),(281,1503,'arrayDiskVendor','array Disk Vendor',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.4.1.674.10893.1.20.130.4.1.3',4025),(282,1503,'arrayDiskChannel','array Disk Channel',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.4.1.674.10893.1.20.130.4.1.10',4032),(283,1503,'arrayDiskLengthInMB','Array Disk Size',2,1,0,1,1,0,0,3,0,1,1,1,'.1.3.6.1.4.1.674.10893.1.20.130.4.1.11',4033),(284,1021,'mak','Net mask',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(1000,0,'current_user','Current logged in user',2,1,1,1,1,0,0,0,0,0,0,0,'',0),(1001,0,'netbios_name','Netbios computer name',2,1,1,1,3,0,0,0,0,0,0,0,'',0),(1002,0,'computer_brand','Computer brand',2,1,2,1,30,0,0,0,0,0,0,0,'',0),(1003,0,'computer_model','Computer model',2,1,2,1,30,0,0,0,0,0,0,0,'',0),(1004,0,'computer_sn','Computer serial no.',2,1,2,1,10,0,0,0,0,0,0,0,'',0),(1005,0,'computer_mb','Computer motherboard',2,1,2,1,10,0,0,0,0,0,0,0,'',0),(1006,0,'cpu','CPU',5,2,2,1,10,0,0,0,0,0,0,0,'',0),(1007,0,'cpu_load','CPU load (%)',1,1,1,1,2,0,0,0,0,0,0,0,'',0),(1008,0,'os_name','OS Name',2,1,1,2,30,0,0,0,0,0,0,0,'',0),(1009,0,'os_version','OS Version',2,1,1,2,60,0,0,0,0,0,0,0,'',0),(1010,0,'ram_hardware','RAM Hardware',5,2,2,1,2,0,0,0,0,0,0,0,'',0),(1011,0,'ram_size','RAM size',5,1,2,1,1,0,0,0,0,0,0,0,'',0),(1012,0,'hdd_hardware','HDD (Hardware)',5,2,1,2,10,0,0,0,0,0,0,0,'',0),(1013,0,'partitions','Partitions (free disk space)',5,2,1,1,60,0,0,0,0,0,0,0,'',0),(1014,0,'cd_rom','CD Rom',2,2,2,2,5,0,0,0,0,0,0,0,'',0),(1015,0,'ports','Ports',2,2,2,2,2,0,0,0,0,0,0,0,'',0),(1016,0,'kbd_layout','Keyboard layout',2,2,1,2,0.1,0,0,0,0,0,0,0,'',0),(1017,0,'os_locale','OS Locale',2,1,1,1,5,0,0,0,0,0,0,0,'',0),(1018,0,'printers','Printers',2,2,1,1,10,0,0,0,0,0,0,0,'',0),(1019,0,'software','Installed software',2,2,3,2,10,0,0,1,0,0,0,0,'',0),(1020,0,'net_protocols','Network protocols',2,2,1,2,10,0,0,0,0,0,0,0,'',0),(1021,0,'net_adapters','Network adapters',5,2,2,2,5,0,0,0,0,0,0,0,'',0),(1022,0,'display_name','Display name',2,1,2,2,10,0,0,0,0,0,0,0,'',0),(1023,0,'display_size','Display size',2,1,1,1,10,0,0,0,0,0,0,0,'',0),(1024,0,'graphic_card','Graphic card',2,1,2,2,10,0,0,0,0,0,0,0,'',0),(1025,0,'anti_virus','Anti-virus status',5,2,3,2,10,0,0,0,0,0,0,0,'',0),(1026,0,'services','Services',5,2,1,1,5,25,0,0,0,0,0,0,'',0),(1027,0,'vnc','VNC info',5,2,1,1,0.5,0,0,0,0,0,0,0,'',0),(1028,0,'ad_users','AD Users',5,2,5,1,60,57,0,0,0,0,0,0,'',0),(1029,0,'ad_users_monitor','AD Users monitoring',5,2,5,1,60,68,0,0,0,0,0,0,'',0),(1030,0,'ad_computers','AD Computers (split in 1046 and 1047)',5,2,5,1,60,117,0,1,0,0,0,0,'',0),(1031,0,'ad_printers','AD Printers',5,2,5,1,60,96,0,0,0,0,0,0,'',0),(1032,0,'ad_groups','AD Groups',5,2,5,1,60,134,0,0,0,0,0,0,'',0),(1033,0,'system_time','System time',7,1,1,1,1,0,0,0,0,1,0,0,'',0),(1034,0,'system_bootup_time','Sytem bootup time',7,1,1,1,10,0,0,0,0,1,0,0,'',0),(1035,0,'chassis_lock','Chassis lock',2,1,2,1,10,0,0,0,0,0,0,0,'',0),(1036,0,'chassis_asset_tag','Chassis asset tag',2,1,2,1,10,0,0,0,0,0,0,0,'',0),(1037,0,'bios','BIOS',5,1,2,1,10,0,0,0,0,0,0,0,'',0),(1038,0,'firmware','Firmware',5,2,2,2,10,0,0,0,0,0,0,0,'',0),(1039,0,'drsc','DRAC',5,1,1,1,10,0,0,0,0,0,0,0,'',0),(1040,0,'slots','Slots',5,2,2,2,10,0,0,0,0,0,0,0,'',0),(1041,0,'storage_controllers','Storage controllers',5,2,2,2,10,0,0,0,0,0,0,0,'',0),(1042,0,'storage_vdisks','Storage vdisks',5,2,2,2,10,0,0,0,0,0,0,0,'',0),(1043,0,'storage_disks','Storage disks',5,2,2,2,10,0,0,0,0,0,0,0,'',0),(1044,0,'backup_status','Backup status',5,1,1,2,0.1,0,0,0,0,0,0,0,'',0),(1045,0,'users_info','User accounts info',5,2,5,2,10,0,0,0,0,0,0,0,'',0),(1046,0,'ad_computers','AD Computers',5,2,5,2,60,228,0,3,0,0,0,0,'',0),(1047,0,'ad_computers_monitoring','AD Computers Monitoring',5,2,5,1,60,235,0,3,0,0,0,0,'',0),(1500,0,'system_info','System info',5,1,1,1,10,0,0,3,0,0,0,1,'.1.3.6.1.2.1.1',1301),(1501,0,'system_state_dell','System state (Dell)',5,2,1,2,5,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.200.10',226),(1502,0,'del_system_state','Dell System State',5,2,1,2,10,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.200.10',226),(1503,0,'arrayDiskTable','Array Disk Table',5,2,2,2,5,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10893.1.20.130.4',4021),(1504,0,'sysStatus_snmp','SCSI Status',1,1,2,2,10,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.1000.60.1.5',0),(1505,0,'sysUpTime_snmp','sysUpTime SNMP',1,1,1,2,10,0,0,3,0,0,0,1,'.1.3.6.1.2.1.1.3.0',0),(1600,0,'snmp_scsistat','Disque Status',1,1,2,2,10,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.1000.60.1.5',0),(2000,0,'comments','Comments',3,1,1,1,1,0,0,0,0,0,0,0,'',0),(2001,0,'warranties','Warranties',5,2,4,1,1,0,0,0,0,0,0,0,'',0),(2002,0,'KSDNS','KS DNS Setup',2,1,3,1,1,0,0,0,0,0,0,0,'',0),(2003,0,'backup','Last backup',7,1,1,1,1,0,0,0,0,1,0,0,'',0),(2004,0,'backup info','Backup info',5,1,1,3,10,0,0,0,0,0,0,0,'',0),(2005,0,'netplug','Network plug',2,1,1,2,1,0,0,0,0,0,0,0,'',0),(2006,0,'location','Physical location',2,1,1,2,1,0,0,0,0,0,0,0,'',0),(2929,0,'moon_secure','AV MoonSecure',8,1,3,2,1,0,0,3,0,0,0,0,'',0),(3000,0,'events_log','Events log',5,2,6,1,5,0,0,1,0,0,0,0,'',0),(5000,0,'switch_interfaces_3com','Switch Interfaces (3Com)',5,2,0,1,10,0,0,3,0,0,0,1,'.1.3.6.1.2.1.2.2',1518),(5001,0,'generic_printer_info','Generic printer info',5,1,0,1,1,0,0,3,0,0,0,1,'.1.3.6.1.2.1.43.10.2',0),(5003,0,'generic_printer_status','Generic printer status',5,1,0,2,10,0,0,3,0,0,0,1,'.1.2.36.1.2',0),(5004,0,'generic_printer_cover_sta','Generic printer cover stat',5,2,0,2,10,0,0,3,0,0,0,1,'.1.3.6.1.2.1.43.6.1',3496),(5005,0,'printer_device_stat','Printer device stat',5,2,0,2,10,0,0,3,0,0,0,1,'.1.3.6.1.2.1.25.3',3302),(5010,0,'snmpUpTime','Uptime Serveur',1,1,0,2,5,0,0,3,0,0,0,1,'.1.3.6.1.2.1.1.3.0',4222),(5011,0,'snmpDiskStatus','Disk statuts',1,1,0,2,5,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.1000.60.1.5',4955),(5012,0,'snmpStateTemp','Status Température',2,2,0,2,5,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.200.10.1.23',4468),(5013,0,'snmpVersionFMHD','Version Firmware',2,2,0,2,5,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.100.2.0',0),(5014,0,'snmpBIOSv','BIOS Version',2,2,0,2,5,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.300.50.1.8',0),(5015,0,'snmpAlertMSG','Alert Message',2,1,0,2,5,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.5000.10.3.0',0),(5016,0,'snmpPreAlertMSG','Prévious Alert Message',2,2,0,2,5,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.5000.10.5.0',0),(5050,0,'snmpRemoteAccessType','Remote Access Type',1,1,0,2,5,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.1700.10.1.3',0),(5051,0,'snmpRAccessStatus','Remote Access Status',1,2,0,2,5,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.1700.10.1.6',0),(5052,0,'snmpDracversion','Drac version',2,1,0,2,5,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.1700.10.1.9',0),(5100,0,'snmpDellUptime','Dell Serveur SYSUPTIME',1,1,0,1,1,0,0,3,0,0,0,1,'.1.3.6.1.2.1.1.3.0',0),(5102,0,'snmpFwHDdell','Version Firmware snmp',2,1,0,2,5,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.100.2.0',0),(5104,0,'snmpVbios','Bios NAME',2,2,0,2,5,0,0,3,0,0,0,1,'.1.3.6.1.4.1.674.10892.1.300.50.1.8',0),(1048,0,'chassis','Chassis',5,1,2,1,60,0,0,3,0,0,0,0,'',0),(285,1048,'model','Model',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(286,1048,'version','Version',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(287,1048,'manufacturer','Manufacturer',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(288,1048,'serial','Serial',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(1049,0,'windows_registration','Windows Registration',5,1,1,1,10,0,0,3,0,0,0,0,'',0),(289,1049,'serial','Serial',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(290,1049,'company','Company',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(291,1049,'owner','Owner',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(292,1049,'install_date','Install Date',7,1,0,1,1,0,0,3,0,1,1,0,'',0),(1050,0,'print_jobs','Print Jobs',5,2,1,1,10,0,0,3,0,0,0,0,'',0),(293,1050,'printer','Printer',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(294,1050,'user','User',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(295,1050,'job','Job',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(296,1050,'status','Status',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(297,1050,'total_pages','Total Pages',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(298,1050,'printed_pages','Printed Pages',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(299,1050,'submitted','Submitted',7,1,0,1,1,0,0,3,0,1,1,0,'',0),(1051,0,'firewall_status','Firewall Status',5,1,1,1,10,0,0,3,0,0,0,0,'',0),(300,1051,'status','Status',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(301,1051,'notif_status','Notification Status',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(302,1051,'remote_administration','Remote Administration',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(1052,0,'firewall_exceptions','Firewall Exceptions',5,2,1,1,10,0,0,3,0,0,0,0,'',0),(303,1052,'type','Type',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(304,1052,'name','Name',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(305,1052,'filename','Filename',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(306,1052,'port','Port',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(307,1052,'status','Status',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(1053,0,'tape_media_info','Tape Media Info',5,1,2,1,10,0,0,3,0,0,0,0,'',0),(308,1053,'info','Info',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(309,1053,'capacity','Capacity',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(310,1053,'remaining','Remaining',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(311,1053,'block_size','Block Size',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(312,1053,'partiotion_count','Partition Count',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(313,1053,'write_protected','Write Protected',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(1054,0,'process_information','Process Information',5,2,1,1,10,0,0,3,0,0,0,0,'',0),(314,1054,'error','Error',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(315,1054,'name','Name',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(316,1054,'pid','Pid',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(317,1054,'menu_usage','Menu Usage',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(318,1054,'cpu_usage','CPU Usage',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(1359,0,'nic_table','NIC Table',5,2,7,1,10,0,0,3,0,0,0,0,'',0),(319,1359,'name','Name',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(320,1359,'speed','Speed',6,1,0,1,1,0,0,3,0,1,1,0,'',0),(321,1359,'number','Number',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(1360,0,'arp_table','ARP Table',5,2,7,1,10,0,0,3,0,0,0,0,'',0),(322,1360,'ip','IP',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(323,1360,'mac','MAC',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(324,1360,'type','Type',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(325,1360,'index','Index',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(1361,0,'ip_addr_table','Ip Addr. Table',5,2,7,1,10,0,0,3,0,0,0,0,'',0),(326,1361,'ip','IP',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(327,1361,'netmask','Netmask',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(328,1361,'interface','Interface',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(1362,0,'route_table','Route Table ',5,2,7,1,10,0,0,3,0,0,0,0,'',0),(329,1362,'netw_dest','Network Dest',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(330,1362,'netmask','Netmask',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(331,1362,'gateway','Gateway',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(332,1362,'interface','Interface',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(333,1362,'metric','Metric',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(1363,0,'conn_table','Conections Table',5,2,7,1,10,0,0,3,0,0,0,0,'',0),(334,1363,'proto','Proto',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(335,1363,'local_addr','Local Addr',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(336,1363,'remote_addr','Remote Addr.',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(337,1363,'state','State',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(338,1363,'proc','Proc',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(1364,0,'ip_stats','IP Statistics',5,2,7,1,10,0,0,3,0,0,0,0,'',0),(339,1364,'ip_desc','IP Desc',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(340,1364,'value','Value',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(1365,0,'icmp_stats','ICMP Statistics',5,2,7,1,10,0,0,3,0,0,0,0,'',0),(341,1365,'icmp_desc','ICMP Desc',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(342,1365,'received','Received',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(343,1365,'sent','Sent',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(1366,0,'if_stats','Interface Statistics',5,2,7,1,10,0,0,3,0,0,0,0,'',0),(344,1366,'if_desc','IF Desc',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(345,1366,'received','Received',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(346,1366,'sent','Sent',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(347,1006,'logical_cpu_no','Logical CPU Number',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(348,1006,'phisical_cpu_no','Phisical CPU Number',1,1,0,1,1,0,0,3,0,1,1,0,'',0),(349,1006,'architecture','Architecture',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(350,1006,'family','Family',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(351,1006,'serial','Serial',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(352,1025,'engine_version','Engine Version',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(353,1025,'patterns_version','Patterns Version',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(354,1037,'vendor','Vendor',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(1055,0,'softwares_ex','Installed software extended',5,2,3,2,60,355,0,3,0,0,0,0,'',0),(355,1055,'name','Name',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(356,1055,'install_date','Installation_date',2,1,0,1,1,0,0,3,0,1,1,0,'',0),(357,1365,'value','Value',1,1,0,1,1,0,0,3,0,1,1,0,'',0)");
    return $bb;
}

function set_customer($customer_name){
    if( ! defined('DB_HOST')) define('DB_HOST', $db_host);
    if( ! defined('DB_USER')) define('DB_USER', $db_user);
    if( ! defined('DB_PWD')) define('DB_PWD', $db_pass);
    if( ! defined('DB_NAME')) define('DB_NAME', $db_name);
    require_once(abs_path('install/db.php'));
    require_once(abs_path('install/db_schema_update.php'));
    $query = "REPLACE INTO `customers` VALUES (2,'" . db::db_escape($customer_name) . "','0',NULL,'','','','','','','',0,'','','','','',1,'','','','','12.00',0,1,1,0,1,0,0,8,'','',5,3,1)";
    $bb=true;
    db::db_query($query);
    return $bb;
}

function apply_database_update($db_host, $db_user, $db_pass, $db_name){
    if( ! defined('DB_HOST')) define('DB_HOST', $db_host);
    if( ! defined('DB_USER')) define('DB_USER', $db_user);
    if( ! defined('DB_PWD')) define('DB_PWD', $db_pass);
    if( ! defined('DB_NAME')) define('DB_NAME', $db_name);
    require_once(abs_path('install/db.php'));
    require_once(abs_path('install/db_schema_update.php'));

    $existing_tables = db::db_fetch_vector("show tables");

    foreach($tables as $table_name=>$tsa){
        $create_stmt = $tsa['create_stmt'];
        if( ! in_array($table_name, $existing_tables)){
           debug("execute creation script: " . $create_stmt);
           db::db_query($create_stmt);
        } else {
           //table  exists, see for each field if it exists
            $fields =  array();
            preg_match_all('/(`\w+`)+\s+(\w+\(*\d*\)*)+/', $create_stmt, $fields);
            foreach($fields[1] as $k => $field){
               $fld = trim($field, '`');
               $query = "select count(*) as cnt from information_schema.columns where table_name='" . $table_name . "' and column_name='" . $fld . "'";
               $bF = db::db_fetch_field($query, 'cnt');
               if($bF == 0){
                   $query = "ALTER TABLE " . $table_name . " add " . $fields[0][$k];
                   debug("executing stmt: " . $query);
                   db::db_query($query);
               }
            }
        }
    }
}


function debug($v){
    print("<pre>");
    print_r($v);
    print("</pre>");
}
